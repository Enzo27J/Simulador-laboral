<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Simulador Laboral</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">

<div class="container py-5">
  <div id="loginCard" class="card shadow mx-auto" style="max-width: 400px;">
    <div class="card-body">
      <h3 class="text-center mb-3">Inicio de Sesi贸n</h3>
      <input id="user" class="form-control mb-2" placeholder="Usuario">
      <input id="pass" class="form-control mb-3" type="password" placeholder="Contrase帽a">
      <button id="loginBtn" class="btn btn-primary w-100">Ingresar</button>
      <div id="errorMsg" class="text-danger mt-2 text-center"></div>
    </div>
  </div>

  <div id="nombreCard" class="card shadow mx-auto mt-4 d-none" style="max-width: 400px;">
    <div class="card-body">
      <h5>Ingrese su nombre:</h5>
      <input id="nombreEstudiante" class="form-control mb-3" placeholder="Nombre completo">
      <button id="continuarBtn" class="btn btn-success w-100">Continuar</button>
    </div>
  </div>

  <div id="menuCard" class="card shadow mx-auto mt-4 d-none" style="max-width: 500px;">
    <div class="card-body text-center">
      <h4 id="bienvenida"></h4>
      <button id="logoutBtn" class="btn btn-outline-danger">Cerrar sesi贸n</button>
      <p class="text-muted">Seleccione un m贸dulo:</p>
      <a href="citas.html" class="btn btn-outline-primary w-100 mb-2">┖ M贸dulo de Citas M茅dicas</a>
      <button class="btn btn-outline-secondary w-100" disabled> M贸dulo de Call Center (pr贸ximamente)</button>
    </div>
  </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $("#loginBtn").click(() => {
    $.ajax({
      url: "/login",
      method: "POST",
      contentType: "application/json",
      data: JSON.stringify({
        username: $("#user").val(),
        password: $("#pass").val()
      }),
      success: res => {
        if (res.success && res.role === "estudiante") {
          $("#loginCard").addClass("d-none");
          $("#nombreCard").removeClass("d-none");
        } else {
          $("#errorMsg").text(res.message || "Usuario no v谩lido");
        }
      }
    });
  });


  $("#continuarBtn").click(() => {
    const nombre = $("#nombreEstudiante").val().trim();
    if (nombre) {
      localStorage.setItem("nombreEstudiante", nombre);
      $("#nombreCard").addClass("d-none");
      $("#menuCard").removeClass("d-none");
      $("#bienvenida").text(`Bienvenido, ${nombre}`);
    }
  });

  $(document).ready(function() {
  $("#logoutBtn").on("click", function() {
    // Redirige de vuelta al login
    window.location.href = "/index.html";
  });

  $("#moduloCitas").on("click", function() {
    window.location.href = "/citas.html";
  });
});

</script>
</body>
</html>
